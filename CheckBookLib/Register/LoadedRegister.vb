Option Strict Off
Option Explicit On
Public Class LoadedRegister
    '2345667890123456789012345678901234567890123456789012345678901234567890123456789012345

    'The Account object this object belongs to. Used to notify the Account object
    'when the Register changes.
    Private mobjAccount As Account
    'The loaded Register object with normal Trx.
    Private WithEvents mobjReg As Register
    'True iff operator deleted register.
    Private mblnDeleted As Boolean

    Public Sub Init(ByVal objAccount_ As Account, ByVal objReg_ As Register)

        mobjAccount = objAccount_
        mobjReg = objReg_
    End Sub

    Public ReadOnly Property objReg() As Register
        Get
            objReg = mobjReg
        End Get
    End Property


    Public Property blnDeleted() As Boolean
        Get
            blnDeleted = mblnDeleted
        End Get
        Set(ByVal Value As Boolean)
            mblnDeleted = Value
        End Set
    End Property

    Private Sub mobjReg_StatusChanged(ByVal lngIndex As Integer) Handles mobjReg.StatusChanged
        gSetAccountChanged(mobjAccount)
    End Sub

    Private Sub mobjReg_TrxAdded(ByVal lngIndex As Integer, ByVal objTrx As Trx) Handles mobjReg.TrxAdded
        If Not objTrx.blnAutoGenerated Then
            gSetAccountChanged(mobjAccount)
        End If
    End Sub

    Private Sub mobjReg_TrxDeleted(ByVal lngIndex As Integer) Handles mobjReg.TrxDeleted
        gSetAccountChanged(mobjAccount)
    End Sub

    Private Sub mobjReg_TrxUpdated(ByVal lngOldIndex As Integer, ByVal lngNewIndex As Integer, ByVal objTrx As Trx) Handles mobjReg.TrxUpdated
        gSetAccountChanged(mobjAccount)
    End Sub

    Private Sub mobjReg_MiscChange() Handles mobjReg.MiscChange
        gSetAccountChanged(mobjAccount)
    End Sub
End Class