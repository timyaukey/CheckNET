Option Strict On
Option Explicit On

Public Class ReplicaTrx
    Inherits Trx

    Public Overrides ReadOnly Property lngType As TrxType
        Get
            Return Trx.TrxType.glngTRXTYP_REPLICA
        End Get
    End Property

    Public Sub NewStartReplica(ByVal objReg As Register, ByVal datDate_ As Date, ByVal strDescription_ As String,
                              ByVal strMemo_ As String, ByVal curAmount_ As Decimal)

        If Not objReg Is Nothing Then
            objReg.ClearFirstAffected()
        End If

        mstrNumber = "Repl"
        mdatDate = datDate_
        mstrDescription = strDescription_
        mstrMemo = strMemo_
        mlngStatus = TrxStatus.glngTRXSTS_NONBANK
        mblnFake = True
        mblnAwaitingReview = False
        mblnAutoGenerated = False
        mcurAmount = curAmount_

        RaiseErrorOnBadData("NewStartReplica")

    End Sub

    Public Overrides Function objClone(objReg As Register) As Trx
        Dim objReplicaTrx As ReplicaTrx = New ReplicaTrx()
        objReplicaTrx.NewStartReplica(objReg, mdatDate, mstrDescription, mstrMemo, mcurAmount)
        Return objReplicaTrx
    End Function

    Public Function objGetTrxManager(objReg As Register) As ReplicaTrxManager
        Return New ReplicaTrxManager(objReg, objReg.lngTrxIndex(Me), Me)
    End Function

    Public Function objGetTrxManager(objReg As Register, lngIndex As Integer) As ReplicaTrxManager
        Return New ReplicaTrxManager(objReg, lngIndex, Me)
    End Function
End Class
