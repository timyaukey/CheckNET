using System;
using System.Management.Automation;

using Willowsoft.CheckBook.Lib;

namespace Willowsoft.CheckBook.Powershell
{

    [Cmdlet(VerbsCommon.New, "CheckbookNormalTrx")]
    [OutputType(typeof(NormalTrx))]
    public class NewNormalTrx : Cmdlet
    {
        [Parameter(Mandatory = true)]
        public Register Register { get; set; }

        [Parameter(Mandatory = true)]
        public DateTime Date { get; set; }

        [Parameter(Mandatory = true)]
        public string Number { get; set; }

        [Parameter(Mandatory = true)]
        public string Description { get; set; }

        [Parameter]
        public Trx.TrxStatus Status { get; set; }

        public NewNormalTrx()
        {
            Status = Trx.TrxStatus.Unreconciled;
        }

        protected override void BeginProcessing()
        {
            NormalTrx normalTrx = new NormalTrx(Register);
            normalTrx.NewStartNormal(blnWillAddToRegister: true,
                strNumber_: Number,
                datDate_: Date,
                strDescription_: Description,
                strMemo_: "",
                lngStatus_: Status,
                blnFake_: true,
                curNormalMatchRange_: 0,
                blnAwaitingReview_: false,
                blnAutoGenerated_: false,
                intRepeatSeq_: 0,
                strImportKey_: "",
                strRepeatKey_: "");
            WriteObject(normalTrx);
        }
    }
}
